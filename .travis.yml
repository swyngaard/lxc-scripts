sudo: required
dist: trusty

env:
    - LD_LIBRARY_PATH=/usr/lib/python3/dist-packages:$LD_LIBRARY_PATH

language: python
python:
    - "3.2"
    - "3.3"
    - "3.4"
    - "3.5"

before_script:
    - echo "deb http://archive.ubuntu.com/ubuntu trusty-backports main" | sudo tee -a /etc/apt/sources.list
    - sudo apt-get -qq update
    - sudo apt-get install -t trusty-backports -y lxc python3-lxc
    - echo "$USER veth lxcbr0 10" | sudo tee -a /etc/lxc/lxc-usernet
    - echo "lxc.id_map = u 0 100000 65536" | sudo tee -a /etc/lxc/default.conf
    - echo "lxc.id_map = g 0 100000 65536" | sudo tee -a /etc/lxc/default.conf
    - echo "/usr/lib/python3/dist-packages" | tee -a $(pip --version | cut -d ' ' -f 4)/lxc.pth
    - cat /etc/sub?id
    - sudo service lxc restart
    - ls /usr/lib/python3/dist-packages/lxc
    - mkdir -p $HOME/.config/lxc
    - cp /etc/lxc/default.conf $HOME/.config/lxc/
    - python -m site

script: python postgresql.py
